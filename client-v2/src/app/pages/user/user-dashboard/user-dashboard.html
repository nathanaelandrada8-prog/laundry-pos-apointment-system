<div class="dashboard-container">
  <header class="welcome-section">
    <div class="user-meta">
      <h1>{{ getGreeting() }}, {{ user()?.firstName }}!</h1>
      <p>Your clothes are in good hands.</p>
    </div>
    <div class="profile-mini" routerLink="/user/profile">
      <img [src]="user()?.profilePictureBase64 || 'https://ui-avatars.com/api/?name=' + user()?.firstName" alt="Avatar">
    </div>
  </header>

  <div class="promo-banner">
    <div class="promo-content">
      <span class="tag">PROMO</span>
      <h2>Get 20% OFF on Comforters</h2>
      <p>Valid until Jan 30. Use code: FRESHBED</p>
    </div>
    <button class="btn-promo" routerLink="/user/order">Book Now</button>
  </div>

  <div class="dashboard-grid">
    <section class="status-card">
      <div class="card-header">
        <h3>Active Booking</h3>
        <span class="dot-pulse" *ngIf="activeOrder()"></span>
      </div>

      @if (activeOrder()) {
        <div class="active-content">
          <div class="status-info">
            <span class="badge">{{ activeOrder().status }}</span>
            <p class="method">{{ activeOrder().method.replace('_', ' ') | titlecase }}</p>
            <p class="date">Pickup: {{ activeOrder().pickupDate }}</p>
          </div>
          <button class="btn-track" routerLink="/user/track-order">
            <span class="material-icons">radar</span>
          </button>
        </div>
      } @else {
        <div class="empty-status">
          <div class="empty-icon"><span class="material-icons">dry_cleaning</span></div>
          <p>Ready for a fresh start?</p>
          <button class="btn-order" routerLink="/user/order">Schedule a Pickup</button>
        </div>
      }
    </section>

    <section class="insights-card">
      <h3>Monthly Insights</h3>
      <div class="stats-grid">
        <div class="stat-item">
          <p class="stat-label">Total Spent</p>
          <p class="stat-value">â‚±{{ stats.totalSpent.toFixed(2) }}</p>
        </div>
        <div class="stat-item">
          <p class="stat-label">Orders</p>
          <p class="stat-value">{{ stats.ordersThisMonth }}</p>
        </div>
        <div class="stat-item">
          <p class="stat-label">Time Saved</p>
          <p class="stat-value">{{ stats.savedTimeHours }}h</p>
        </div>
      </div>
    </section>
  </div>

  <h3 class="section-title">Quick Services</h3>
  <section class="actions-grid">
    <div class="action-tile" routerLink="/user/order">
      <div class="icon-box wash"><span class="material-icons">wash</span></div>
      <h4>New Request</h4>
    </div>
    <div class="action-tile" routerLink="/user/profile">
      <div class="icon-box profile"><span class="material-icons">location_on</span></div>
      <h4>Address</h4>
    </div>
    <div class="action-tile">
      <div class="icon-box history"><span class="material-icons">receipt_long</span></div>
      <h4>Invoices</h4>
    </div>
    <div class="action-tile">
      <div class="icon-box support"><span class="material-icons">chat_bubble_outline</span></div>
      <h4>Help</h4>
    </div>
  </section>
</div>
